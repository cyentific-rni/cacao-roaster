services:
    mongodb_container:
        image: mongo:latest
        container_name: mongo_soarca_stack
        environment:
            MONGO_INITDB_ROOT_USERNAME: 'root'
            MONGO_INITDB_ROOT_PASSWORD: 'rootpassword'
        networks:
            - db-net
        volumes:
            - type: volume
              source: mongodb_data_container
              target: /data/db
    soarca:
        image: cossas/soarca:development
        container_name: soarca_server
        environment:
            PORT: 8080
            SOARCA_ALLOWED_ORIGINS: '*'
            MONGODB_URI: 'mongodb://mongodb_container:27017'
            DATABASE_NAME: 'soarca'
            DB_USERNAME: 'root'
            DB_PASSWORD: 'rootpassword'
            PLAYBOOK_API_LOG_LEVEL: trace
            DATABASE: 'true'
            LOG_GLOBAL_LEVEL: 'trace'
            LOG_MODE: 'production'
            LOG_FILE_PATH: ''
            LOG_FORMAT: 'json'
            ENABLE_FINS: false
            MQTT_BROKER: 'mosquitto'
            MQTT_PORT: 1883
        networks:
            - db-net
            - demo-net
        ports:
            - 0.0.0.0:8080:8080
        depends_on:
            - mongodb_container
    roaster:
        build:
            dockerfile: Dockerfile
        container_name: roaster
        environment:
            PORT: 3000
        networks:
            - demo-net
        ports:
            - 0.0.0.0:3000:3000
networks:
    db-net:
    demo-net:
volumes:
    mongodb_data_container:
